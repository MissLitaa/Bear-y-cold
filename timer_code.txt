using TextMeshPro;
using UnityEngine.UI;

[HideInInspector]public float currentTime = 0f;
[HideInInspector]public float startingTime = 30f;
[HideInInspector]public TMPro timeDisplay;
[HideInInspector]public bool timerIsRunning;
[HideInInspector]public bool restartTimer;

public ParticleSystem confettiParticles;
public AudioSource confettiAudio;

public GameObject shopGEO;
public GameObject player;
[HideInInspector]public bool isShopOpen;
[HideInInspector]public bool isInShop;
[HideInInspector]public Vector3 shopPosition;
[HideInInspector]public Vector3 playerPosition;
[HideInInspector]public int playerIsInRange = 2;

[HideInInspector]public int methodIsRunning = 0;


private void Start()
{
	currentTime = startingTime;
	timerIsRunning = true;
	shopPosition = shopGEO.transform.position;
	
}

void Update()
{
	playerPosition = player.transform.position
	currentTime -= 1 * Time.deltaTime;
	timeDisplay.text = currentTime.ToString ("0");

	if (currentTime <=0)
	{
		currentTime = 0;
		timerIsRunning = false;
		4//stop enemy spawn here
		if (methodIsRunning == 0 && timerIsRunning == false)
		{
			methodIsRunning++;
			openShop();
		}

		2//particles confetti here
		3//confetti sound here
		
	}

	while (timerIsRunning)
	{
		isShopOpen = false;
		isInShop = false;
		yield return null;
	}
}

void openShop();
{
isShopOpen = true;

if (Vector3.Distance(playerPosition, shopPosition < playerIsInRange)
{
	if (Input.GetKeyDown.KeyCode(E))
	{
		isInShop = true;
		//call shop system here. (scenemode.additive, el canvas de la hud de la tienda)
		//update inventory if necessary.
	}

	else if (Input.GetKeyDown.KeyCode(E) && isInShop == true)
	{
		//close shop system first
		isInShop = false;
		isShopOpen = false;
	}
}
}
	

